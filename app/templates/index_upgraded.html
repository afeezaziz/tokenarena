{% extends 'base.html' %}
  {% block head_extra %}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Home",
    "url": "{{ canonical_url }}",
    "description": "{{ description or DEFAULT_DESCRIPTION }}"
  }
  </script>
  {% endblock %}

{% block scripts %}
  <script defer src="{{ url_for('static', filename='js/home.js') }}?v={{ STATIC_VERSION }}"></script>
{% endblock %}
  {% block content %}
  <section class="hero">
    <div class="hero-content">
      <div class="pill"><span class="dot"></span> Live Demo</div>
      <h1>Token Arena<br><span class="gradient-text">Battle-tested Market Intel</span></h1>
      <p class="subtitle">Real-time leaderboards, holder analytics, RGB asset launchpad, and lightning-fast trading insights across the Bitcoin ecosystem.</p>
      <div class="cta-row">
        <a href="/dashboard" class="btn btn-cta dashboard-btn"><span class="label">Open Dashboard</span> <span class="arrow" aria-hidden="true">→</span></a>
        <a href="/launchpad" class="btn btn-secondary">Launch RGB Asset</a>
        <a href="/#tokens" class="btn">Explore Tokens</a>
      </div>
      <div class="hero-stats">
        <div class="hero-stat"><span id="hero-tokens" class="value">—</span><span class="label">Tokens</span></div>
        <div class="hero-stat"><span id="hero-holders" class="value">—</span><span class="label">Holders</span></div>
        <div class="hero-stat"><span id="hero-volume" class="value">—</span><span class="label">24h Volume</span></div>
      </div>
    </div>
  </section>

  <!-- Featured Products -->
  <section class="products" id="products">
    <div class="section-header">
      <h2>Powerful Tools for Bitcoin Ecosystem</h2>
      <p class="section-subtitle">Everything you need to track, trade, and launch in the RGB ecosystem</p>
    </div>
    <div class="products-grid">
      <div class="product-card featured">
        <div class="product-icon">⚔️</div>
        <h3>Arena</h3>
        <p>Real-time token leaderboards with advanced metrics: returns, holders growth, market share delta, and composite scoring.</p>
        <a href="/arena" class="product-link">Explore Arena →</a>
      </div>
      <div class="product-card">
        <div class="product-icon">🚀</div>
        <h3>Launchpad</h3>
        <p>Mint new RGB assets via your RLN node and create custom BTC↔RGB vAMM pools with virtual liquidity.</p>
        <a href="/launchpad" class="product-link">Launch Asset →</a>
      </div>
      <div class="product-card">
        <div class="product-icon">💼</div>
        <h3>Dashboard</h3>
        <p>Manage your wallet: view BTC node balance, asset holdings, deposit/withdrawal history, and create invoices.</p>
        <a href="/dashboard" class="product-link">Open Dashboard →</a>
      </div>
    </div>
  </section>

  <!-- Key Features -->
  <section class="features" id="features">
    <div class="section-header">
      <h2>Built for the RGB Ecosystem</h2>
      <p class="section-subtitle">Professional-grade tools with enterprise reliability</p>
    </div>
    <div class="features-grid">
      <div class="feature-card">
        <div class="feature-icon">📊</div>
        <h3>Advanced Analytics</h3>
        <p>7-day Sharpe ratios, holders growth tracking, market share deltas, and composite scoring algorithms.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">⚡</div>
        <h3>Lightning Integration</h3>
        <p>Native RGB Lightning Node integration for seamless BTC and RGB asset deposits and withdrawals.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">🔄</div>
        <h3>vAMM Trading</h3>
        <p>Virtual automated market makers with customizable fees and virtual liquidity for new asset pairs.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">🎯</div>
        <h3>Real-time Data</h3>
        <p>Live market data, instant sparklines, and sub-second updates across all metrics and leaderboards.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">🏆</div>
        <h3>Competitions</h3>
        <p>Run trading competitions with custom scoring, leaderboards, and participant tracking.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">🔐</div>
        <h3>Nostr Auth</h3>
        <p>Secure authentication via Nostr keys with session management and user profile support.</p>
      </div>
    </div>
  </section>

  <!-- Demo Controls -->
  <section class="demo-section" id="demo-presets">
    <div class="section-header">
      <h2>Try Demo Mode</h2>
      <p class="section-subtitle">Explore with realistic mock data - no setup required</p>
    </div>
    <div class="segmented" id="demo-presets-buttons" style="margin: 6px 0 10px;">
      <div class="btn" data-preset="calm-small">Calm · Small</div>
      <div class="btn active" data-preset="normal-medium">Normal · Medium</div>
      <div class="btn" data-preset="degen-large">Degen · Large</div>
    </div>
    <div class="muted" style="font-size:13px">💡 Presets automatically enable Demo Mode with different market conditions and dataset sizes.</div>
  </section>

  <section class="stats-grid" id="market-stats">
  <div class="stat-card">
    <div class="stat-label">Total Market Cap</div>
    <div id="stat-market-cap" class="stat-value">—</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">24h Volume</div>
    <div id="stat-volume" class="stat-value">—</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">Total Tokens</div>
    <div id="stat-tokens" class="stat-value">—</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">Total Holders</div>
    <div id="stat-holders" class="stat-value">—</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">Top Dominance</div>
    <div id="stat-dominance" class="stat-value">—</div>
  </div>
  </section>

<section class="battles" id="tokens">
  <h2>Leaderboard — Top Movers</h2>
  <div class="segmented" id="movers-metric" style="margin: 6px 0 10px;">
    <div class="btn active" data-metric="change_24h">24h</div>
    <div class="btn" data-metric="r7">7D</div>
    <div class="btn" data-metric="r7_sharpe">Sharpe 7D</div>
    <div class="btn" data-metric="holders_growth_pct_24h">Holders 24h</div>
    <div class="btn" data-metric="share_delta_7d">Share Δ 7D</div>
    <div class="btn" data-metric="turnover_pct">Turnover</div>
    <div class="btn" data-metric="composite">Composite</div>
  </div>
  <div id="top-movers" class="movers"></div>

  <div class="table-tools">
    <input id="tokens-filter" class="search-input small" type="search" placeholder="Filter tokens (symbol or name)…" autocomplete="off" />
    <input id="min-mcap" class="search-input small" type="number" inputmode="numeric" placeholder="Min Mcap (USD)" style="max-width: 160px;" />
    <input id="min-volume" class="search-input small" type="number" inputmode="numeric" placeholder="Min Vol 24h (USD)" style="max-width: 180px;" />
    <div class="tool-buttons">
      <button class="btn" id="export-csv">Export CSV</button>
    </div>
    <div class="segmented" id="table-metric" style="margin-left:auto;">
      <div class="btn active" data-metric="change_24h">24h</div>
      <div class="btn" data-metric="r7">7D</div>
      <div class="btn" data-metric="r7_sharpe">Sharpe 7D</div>
      <div class="btn" data-metric="holders_growth_pct_24h">Holders 24h</div>
      <div class="btn" data-metric="share_delta_7d">Share Δ 7D</div>
      <div class="btn" data-metric="turnover_pct">Turnover</div>
      <div class="btn" data-metric="composite">Composite</div>
    </div>
    <div class="segmented" id="spark-range">
      <div class="btn active" data-days="7">7D</div>
      <div class="btn" data-days="30">30D</div>
    </div>
  </div>

  <div class="table-wrapper">
    <table class="tokens-table" aria-label="Tokens">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col" class="sortable" data-key="symbol">Token <span class="arrow">▼</span></th>
          <th scope="col" class="sortable" data-key="price_usd">Price <span class="arrow">▼</span></th>
          <th scope="col" id="spark-col-label">7d</th>
          <th scope="col" class="sortable" data-key="market_cap_usd">Market Cap <span class="arrow">▼</span></th>
          <th scope="col" class="sortable" data-key="holders_count">Holders <span class="arrow">▼</span></th>
          <th scope="col" class="sortable" data-metric="metric" id="metric-col-label">Metric <span class="arrow">▼</span></th>
          <th scope="col" class="sortable" data-key="change_24h">24h <span class="arrow">▼</span></th>
        </tr>
      </thead>
      <tbody id="tokens-tbody"></tbody>
    </table>
  </div>
  <div class="pagination-bar">
    <div class="rows-select">Rows:
      <select id="page-size">
        <option value="10">10</option>
        <option value="25">25</option>
        <option value="50">50</option>
      </select>
    </div>
    <div class="pagination" id="tokens-pagination"></div>
  </div>
</section>

<section class="charts" id="charts">
  <h2>Ecosystem Charts</h2>
  <div class="segmented" id="global-range" style="margin: 6px 0 12px;">
    <div class="btn" data-range="7d">7D</div>
    <div class="btn active" data-range="30d">30D</div>
    <div class="btn" data-range="90d">90D</div>
    <div class="btn" data-range="all">All</div>
  </div>
  <div class="charts-grid">
    <div class="chart-card">
      <h3>Number of Tokens Over Time</h3>
      <canvas id="globalTokensChart"></canvas>
    </div>
    <div class="chart-card">
      <h3>Number of Holders Over Time</h3>
      <canvas id="globalHoldersChart"></canvas>
    </div>
  </div>
</section>

<!-- What's New -->
<section class="whats-new-section" id="whats-new">
  <div class="section-header">
    <h2>What's New</h2>
    <p class="section-subtitle">Latest updates and features</p>
  </div>
  <div id="whats-new-list" class="whats-new-grid"></div>
</section>

<!-- CTA Section -->
<section class="cta-section">
  <div class="cta-content">
    <h2>Ready to Battle?</h2>
    <p>Join the arena and start tracking the RGB ecosystem with professional-grade tools.</p>
    <div class="cta-buttons">
      <a href="/dashboard" class="btn btn-cta">Get Started</a>
      <a href="/arena" class="btn btn-outline">View Leaderboard</a>
    </div>
  </div>
</section>

<style>
  .hero { position: relative; overflow: hidden; }
  .hero::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(ellipse at center, rgba(124,92,255,0.1) 0%, transparent 70%); pointer-events: none; }
  .hero-content { position: relative; z-index: 1; }
  .gradient-text { background: linear-gradient(135deg, #7c5cff, #00d1b2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
  .btn-secondary { background: rgba(124,92,255,0.1); border: 1px solid rgba(124,92,255,0.3); color: #7c5cff; }
  .btn-secondary:hover { background: rgba(124,92,255,0.2); }
  .hero-stats { display: flex; gap: 24px; margin-top: 20px; }
  .hero-stat { text-align: center; }
  .hero-stat .value { display: block; font-size: 1.5rem; font-weight: 700; color: var(--text); }
  .hero-stat .label { font-size: 0.8rem; color: var(--text-secondary); }
  
  .section-header { text-align: center; margin-bottom: 32px; }
  .section-header h2 { margin: 0 0 8px; font-size: 2rem; }
  .section-subtitle { color: var(--text-secondary); font-size: 1.1rem; margin: 0; }
  
  .products-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
  .product-card { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 20px; transition: transform 0.2s ease, border-color 0.2s ease; }
  .product-card:hover { transform: translateY(-2px); border-color: var(--accent); }
  .product-card.featured { border-color: var(--accent); background: linear-gradient(135deg, rgba(124,92,255,0.05), rgba(0,209,178,0.05)); }
  .product-icon { font-size: 2rem; margin-bottom: 12px; }
  .product-card h3 { margin: 0 0 8px; color: var(--text); }
  .product-card p { color: var(--text-secondary); margin: 0 0 16px; line-height: 1.5; }
  .product-link { color: var(--accent); text-decoration: none; font-weight: 600; }
  .product-link:hover { color: var(--accent-2); }
  
  .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
  .feature-card { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 20px; }
  .feature-icon { font-size: 1.5rem; margin-bottom: 12px; }
  .feature-card h3 { margin: 0 0 8px; color: var(--text); }
  .feature-card p { color: var(--text-secondary); margin: 0; line-height: 1.5; }
  
  .demo-section { text-align: center; }
  .whats-new-grid { display: grid; gap: 16px; }
  .whats-new-grid .panel { background: var(--panel); border: 1px solid var(--border); border-radius: 10px; padding: 16px; }
  .whats-new-grid h3 { margin: 0 0 8px; color: var(--text); font-size: 1rem; }
  .whats-new-grid ul { margin: 0; padding-left: 16px; }
  .whats-new-grid li { color: var(--text-secondary); margin-bottom: 4px; }
  
  .cta-section { background: linear-gradient(135deg, rgba(124,92,255,0.1), rgba(0,209,178,0.1)); border: 1px solid rgba(124,92,255,0.2); border-radius: 16px; padding: 40px 20px; text-align: center; margin-top: 40px; }
  .cta-content h2 { margin: 0 0 8px; color: var(--text); }
  .cta-content p { color: var(--text-secondary); margin: 0 0 24px; }
  .cta-buttons { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; }
  .btn-outline { background: transparent; border: 1px solid var(--accent); color: var(--accent); }
  .btn-outline:hover { background: rgba(124,92,255,0.1); }
  
  @media (max-width: 640px) {
    .hero-stats { flex-direction: column; gap: 16px; }
    .cta-buttons { flex-direction: column; align-items: center; }
  }
</style>
{% endblock %}
