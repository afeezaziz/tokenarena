{% extends 'base.html' %}
{% block head_extra %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "Launchpad",
  "url": "{{ canonical_url }}",
  "description": "{{ description or DEFAULT_DESCRIPTION }}"
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {"@type": "ListItem", "position": 1, "name": "Home", "item": "{{ SITE_URL }}"},
    {"@type": "ListItem", "position": 2, "name": "Launchpad", "item": "{{ canonical_url }}"}
  ]
}
</script>
{% endblock %}
{% block content %}
<section class="hero">
  <h1>Launchpad</h1>
  <p class="subtitle">Mint new RGB assets and create custom BTC↔RGB vAMM pools.</p>
</section>

<section class="lp-wrap">
  <div class="lp-grid">
    <div class="lp-card">
      <h2>Mint New RGB Asset</h2>
      <p class="muted">Issues a new RGB NIA asset via your configured RLN node and creates a BTC↔RGB vAMM with virtual liquidity.</p>
      <form id="mint-form" class="form-grid">
        <label>
          <span>Ticker</span>
          <input id="mint-ticker" class="search-input" maxlength="20" placeholder="e.g. ARENA" required>
        </label>
        <label>
          <span>Name</span>
          <input id="mint-name" class="search-input" maxlength="128" placeholder="Token Arena" required>
        </label>
        <label>
          <span>Precision</span>
          <input id="mint-precision" class="search-input" type="number" min="0" max="18" value="0">
        </label>
        <label>
          <span>Total Supply (ints)</span>
          <input id="mint-supply" class="search-input" type="number" min="1" step="1" placeholder="1000000" required>
        </label>
        <label>
          <span>Initial Price (BTC per RGB)</span>
          <input id="mint-initial-price" class="search-input" type="number" min="0" step="0.00000001" placeholder="0.00001" required>
        </label>
        <label>
          <span>Virtual Depth (BTC)</span>
          <input id="mint-virtual-depth" class="search-input" type="number" min="0" step="0.00000001" placeholder="0.25" required>
        </label>
        <div class="actions">
          <button type="submit" class="btn primary">Mint & Create Pool</button>
        </div>
      </form>
      <div id="mint-status" class="lp-status" style="display:none"></div>
      <pre id="mint-output" class="lp-output" aria-live="polite"></pre>
    </div>

    <div class="lp-card">
      <h2>Create Pool for Existing RGB</h2>
      <p class="muted">Create a BTC↔RGB vAMM for an existing RGB asset. Select by symbol or paste the RLN Asset ID.</p>
      <form id="pool-form" class="form-grid">
        <label>
          <span>Existing Symbol</span>
          <select id="existing-asset-select" class="search-input">
            <option value="">Select asset…</option>
          </select>
        </label>
        <label>
          <span>RLN Asset ID</span>
          <input id="pool-rln-asset-id" class="search-input" placeholder="rgb1... (optional if symbol chosen)">
        </label>
        <label>
          <span>Initial Price (BTC per RGB)</span>
          <input id="pool-initial-price" class="search-input" type="number" min="0" step="0.00000001" placeholder="0.00001" required>
        </label>
        <label>
          <span>Virtual Depth (BTC)</span>
          <input id="pool-virtual-depth" class="search-input" type="number" min="0" step="0.00000001" placeholder="0.25" required>
        </label>
        <label>
          <span>Total Fee (bps)</span>
          <input id="pool-fee-bps" class="search-input" type="number" min="0" max="500" value="100">
        </label>
        <label>
          <span>LP Fee (bps)</span>
          <input id="pool-lp-fee-bps" class="search-input" type="number" min="0" max="500" value="50">
        </label>
        <label>
          <span>Platform Fee (bps)</span>
          <input id="pool-platform-fee-bps" class="search-input" type="number" min="0" max="500" value="50">
        </label>
        <div class="actions">
          <button type="submit" class="btn">Create Pool</button>
        </div>
      </form>
      <div id="pool-status" class="lp-status" style="display:none"></div>
      <pre id="pool-output" class="lp-output" aria-live="polite"></pre>
    </div>
  </div>

  <div class="lp-card">
    <h2>Existing RGB Assets</h2>
    <div id="existing-assets-list" class="assets-list"></div>
  </div>
  
  <div class="lp-grid">
    <div class="lp-card">
      <h2>Recent Activity</h2>
      <div id="lp-activity" class="activity-list">
        <div class="muted small">No activity yet</div>
      </div>
    </div>
    <div class="lp-card">
      <h2>Tips</h2>
      <ul class="tips-list">
        <li>Use Mint & Create Pool to issue a new RGB asset and instantly create a BTC↔RGB vAMM.</li>
        <li>Prefer higher virtual depth for smoother price impact in early trading.</li>
        <li>You can also create a pool for an existing RGB by selecting the symbol or providing the RLN Asset ID.</li>
        <li>In Demo Mode, responses are mocked so you can trial the full workflow safely.</li>
      </ul>
    </div>
  </div>
</section>

<script src="/static/js/launchpad.js"></script>

<style>
  .lp-wrap { display: grid; gap: 20px; }
  .lp-grid { display: grid; gap: 20px; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); }
  .lp-card { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 16px; }
  .form-grid { display: grid; gap: 10px; grid-template-columns: 1fr 1fr; }
  .form-grid label { display: flex; flex-direction: column; gap: 6px; font-size: 0.875rem; }
  .form-grid label span { color: var(--text-secondary); }
  .form-grid .search-input { width: 100%; padding: 8px 10px; background: var(--bg); border: 1px solid var(--border); border-radius: 6px; color: var(--text); }
  .form-grid .actions { grid-column: 1 / -1; display: flex; justify-content: flex-end; }
  .lp-status { margin-top: 8px; padding: 8px 10px; border-radius: 6px; font-size: 0.875rem; }
  .lp-status.info { background: rgba(124,92,255,0.1); color: #c9c1ff; border: 1px solid rgba(124,92,255,0.3); }
  .lp-status.success { background: rgba(16,185,129,0.12); color: #a7f3d0; border: 1px solid rgba(16,185,129,0.35); }
  .lp-status.error { background: rgba(239,68,68,0.12); color: #fecaca; border: 1px solid rgba(239,68,68,0.35); }
  .lp-output { margin-top: 10px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; padding: 10px; max-height: 240px; overflow: auto; }
  .assets-list { display: grid; gap: 10px; }
  .asset-card { border: 1px solid var(--border); border-radius: 10px; padding: 10px; background: var(--bg); }
  .asset-row { display: flex; align-items: center; gap: 10px; justify-content: space-between; }
  .asset-sym { font-weight: 700; color: var(--text); }
  .asset-name { color: var(--text-secondary); }
  .asset-meta { font-size: 0.8rem; color: var(--text-secondary); }
  .asset-id { margin-top: 6px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 0.78rem; color: var(--text-secondary); word-break: break-all; }
  .activity-list { display: grid; gap: 8px; }
  .activity-item { display:flex; align-items:center; justify-content:space-between; gap:10px; border:1px solid var(--border); border-radius:8px; padding:8px 10px; background: var(--bg); }
  .activity-item .meta { color: var(--text-secondary); font-size: 0.8rem; }
  .tips-list { margin: 0; padding-left: 18px; color: var(--text-secondary); line-height: 1.5; }
  @media (max-width: 720px){ .form-grid { grid-template-columns: 1fr; } }
</style>
{% endblock %}